FROM oven/bun:1.2.18-alpine AS base

WORKDIR /app

# Install dependencies in the image for self-contained setup
COPY package.json bun.lock ./
RUN bun install

# Copy TypeScript and Vite config files needed for development
COPY tsconfig.app.json tsconfig.json tsconfig.node.json vite.config.ts ./

# Source code will be mounted via volume for hot reload
# So we don't copy ./src, ./public, or index.html here

ARG UI_PORT

ARG API_HOST

ARG API_PORT

ARG USE_HTTPS

ENV UI_PORT=$UI_PORT

ENV VITE_API_HOST=$API_HOST

ENV VITE_API_PORT=$API_PORT

ENV VITE_USE_HTTPS=$USE_HTTPS

CMD ["bun", "run", "dev","--host"]

